<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Catur Minimalis</title>

<style>
body{
    margin:0;
    background:#f4f6f8;
    font-family:Arial, sans-serif;
    display:flex;
    flex-direction:column;
    align-items:center;
}

h1{
    margin:20px 0 10px;
    font-weight:500;
}

.turn{
    margin-bottom:10px;
    font-size:14px;
    color:#555;
}

.board{
    width:95vw;
    max-width:500px;
    aspect-ratio:1;
    display:grid;
    grid-template-columns:repeat(8,1fr);
    border:2px solid #333;
}

.square{
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:clamp(20px,5vw,40px);
    cursor:pointer;
    user-select:none;
}

.light{ background:#ffffff; }
.dark{ background:#d9d9d9; }

.selected{
    outline:3px solid #4CAF50;
}

.white-piece{
    color:white;
    text-shadow:0 0 2px #000;
}

.black-piece{
    color:black;
}

@media(max-width:500px){
    h1{font-size:18px;}
}
</style>
</head>
<body>

<h1>Game Catur</h1>
<div class="turn">Giliran: <span id="turnText">Putih</span></div>
<div class="board" id="board"></div>

<script>
const boardElement = document.getElementById("board");
const turnText = document.getElementById("turnText");

let board = [];
let selected = null;
let currentPlayer = "white";

const pieces = {
    r:"♜", n:"♞", b:"♝", q:"♛", k:"♚", p:"♟",
    R:"♖", N:"♘", B:"♗", Q:"♕", K:"♔", P:"♙"
};

function initBoard(){
    board = [
        ["r","n","b","q","k","b","n","r"],
        ["p","p","p","p","p","p","p","p"],
        ["","","","","","","",""],
        ["","","","","","","",""],
        ["","","","","","","",""],
        ["","","","","","","",""],
        ["P","P","P","P","P","P","P","P"],
        ["R","N","B","Q","K","B","N","R"]
    ];
    renderBoard();
}

function renderBoard(){
    boardElement.innerHTML="";
    for(let r=0;r<8;r++){
        for(let c=0;c<8;c++){
            const square=document.createElement("div");
            square.classList.add("square");
            square.classList.add((r+c)%2==0?"light":"dark");
            square.dataset.row=r;
            square.dataset.col=c;

            const piece=board[r][c];
            if(piece){
                square.textContent=pieces[piece];
                if(piece===piece.toUpperCase())
                    square.classList.add("white-piece");
                else
                    square.classList.add("black-piece");
            }

            square.addEventListener("click", handleClick);
            boardElement.appendChild(square);
        }
    }
}

function handleClick(e){
    const r=parseInt(e.currentTarget.dataset.row);
    const c=parseInt(e.currentTarget.dataset.col);
    const piece=board[r][c];

    if(selected){
        if(movePiece(selected.r,selected.c,r,c)){
            selected=null;
            currentPlayer=currentPlayer==="white"?"black":"white";
            turnText.textContent=currentPlayer==="white"?"Putih":"Hitam";
            renderBoard();
        }else{
            selected=null;
            renderBoard();
        }
    }else{
        if(piece && isCurrentPlayerPiece(piece)){
            selected={r,c};
            e.currentTarget.classList.add("selected");
        }
    }
}

function isCurrentPlayerPiece(piece){
    if(currentPlayer==="white")
        return piece===piece.toUpperCase();
    return piece===piece.toLowerCase();
}

function movePiece(sr,sc,tr,tc){
    const piece=board[sr][sc];
    if(!isValidMove(piece,sr,sc,tr,tc)) return false;
    board[tr][tc]=piece;
    board[sr][sc]="";
    return true;
}

function isPathClear(sr,sc,tr,tc){
    const dr=Math.sign(tr-sr);
    const dc=Math.sign(tc-sc);
    let r=sr+dr, c=sc+dc;
    while(r!==tr || c!==tc){
        if(board[r][c]!="") return false;
        r+=dr; c+=dc;
    }
    return true;
}

function isValidMove(piece,sr,sc,tr,tc){
    if(sr===tr && sc===tc) return false;
    const target=board[tr][tc];
    if(target && isCurrentPlayerPiece(target)) return false;

    const dr=tr-sr;
    const dc=tc-sc;
    const absDr=Math.abs(dr);
    const absDc=Math.abs(dc);

    switch(piece.toLowerCase()){
        case "p":
            const dir = piece===piece.toUpperCase()?-1:1;
            if(dc===0 && !target){
                if(dr===dir) return true;
                if((sr===6 && dir===-1 || sr===1 && dir===1) && dr===2*dir && !board[sr+dir][sc]) return true;
            }
            if(absDc===1 && dr===dir && target) return true;
            return false;

        case "r":
            if(sr===tr || sc===tc) return isPathClear(sr,sc,tr,tc);
            return false;

        case "n":
            return (absDr===2 && absDc===1)||(absDr===1 && absDc===2);

        case "b":
            if(absDr===absDc) return isPathClear(sr,sc,tr,tc);
            return false;

        case "q":
            if(absDr===absDc || sr===tr || sc===tc)
                return isPathClear(sr,sc,tr,tc);
            return false;

        case "k":
            return absDr<=1 && absDc<=1;
    }
    return false;
}

initBoard();
</script>

</body>
</html>