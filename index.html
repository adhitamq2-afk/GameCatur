<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catur PRO++</title>

<style>
body{
    margin:0;
    background:#111;
    font-family:system-ui, sans-serif;
    display:flex;
    flex-direction:column;
    align-items:center;
    color:white;
}
h1{ margin:15px 0 5px; font-weight:500; }
.info{ font-size:14px; margin-bottom:10px; color:#ccc; }

.board{
    width:95vw;
    max-width:480px;
    aspect-ratio:1;
    display:grid;
    grid-template-columns:repeat(8,1fr);
    border:2px solid #fff;
}
.square{
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:clamp(22px,5vw,42px);
    cursor:pointer;
    transition:background .2s;
}
.light{ background:#ffffff; }
.dark{ background:#000000; }

.red{ color:#e53935; text-shadow:0 0 3px #000; }
.black{ color:#000; }

.selected{
    box-shadow:inset 0 0 0 4px #4CAF50;
}

.move-hint{
    position:relative;
}
.move-hint::after{
    content:"";
    width:15px;
    height:15px;
    background:rgba(33,150,243,.8);
    border-radius:50%;
    position:absolute;
}

.piece{
    transition:transform .2s ease;
}
.piece.moving{
    transform:scale(1.2);
}

button{
    margin:12px;
    padding:8px 16px;
    border:none;
    border-radius:20px;
    background:white;
    color:black;
    cursor:pointer;
}
button:hover{ opacity:.8; }
</style>
</head>

<body>

<h1>Catur PRO++</h1>
<div class="info" id="info">Giliran: Merah</div>
<div class="board" id="board"></div>
<button onclick="restart()">Restart</button>

<script>
const boardEl=document.getElementById("board");
const info=document.getElementById("info");

const pieces={
r:"♜",n:"♞",b:"♝",q:"♛",k:"♚",p:"♟",
R:"♖",N:"♘",B:"♗",Q:"♕",K:"♔",P:"♙"
};

let board,turn,selected;

function restart(){
board=[
["r","n","b","q","k","b","n","r"],
["p","p","p","p","p","p","p","p"],
["","","","","","","",""],
["","","","","","","",""],
["","","","","","","",""],
["","","","","","","",""],
["P","P","P","P","P","P","P","P"],
["R","N","B","Q","K","B","N","R"]
];
turn="white";
selected=null;
render();
info.textContent="Giliran: Merah";
}

function render(){
boardEl.innerHTML="";
for(let r=0;r<8;r++){
for(let c=0;c<8;c++){
const s=document.createElement("div");
s.className=`square ${(r+c)%2?"dark":"light"}`;
s.dataset.r=r;s.dataset.c=c;

const p=board[r][c];
if(p){
const span=document.createElement("span");
span.textContent=pieces[p];
span.classList.add("piece");
span.classList.add(p===p.toUpperCase()?"red":"black");
s.appendChild(span);
}

s.onclick=()=>click(r,c);
boardEl.appendChild(s);
}}}

function click(r,c){
clearHints();
const p=board[r][c];

if(selected){
if(legal(selected.r,selected.c,r,c)){
animateMove(selected.r,selected.c,r,c);
board[r][c]=board[selected.r][selected.c];
board[selected.r][selected.c]="";
turn=turn==="white"?"black":"white";
info.textContent="Giliran: "+(turn==="white"?"Merah":"Hitam");
}
selected=null;
render();
return;
}

if(p && isMine(p)){
selected={r,c};
highlightMoves(r,c);
}
}

function isMine(p){
return turn==="white"?p===p.toUpperCase():p===p.toLowerCase();
}

function highlightMoves(r,c){
const squares=document.querySelectorAll(".square");
squares.forEach(s=>{
const tr=parseInt(s.dataset.r);
const tc=parseInt(s.dataset.c);
if(legal(r,c,tr,tc)){
s.classList.add("move-hint");
}
if(tr===r && tc===c){
s.classList.add("selected");
}
});
}

function clearHints(){
document.querySelectorAll(".square").forEach(s=>{
s.classList.remove("move-hint","selected");
});
}

function animateMove(sr,sc,tr,tc){
const index=sr*8+sc;
const piece=boardEl.children[index].querySelector(".piece");
if(piece){
piece.classList.add("moving");
setTimeout(()=>piece.classList.remove("moving"),200);
}
}

function legal(sr,sc,tr,tc){
if(sr===tr && sc===tc) return false;
const p=board[sr][sc];
const t=board[tr][tc];
if(t && isMine(t)) return false;

const dr=tr-sr, dc=tc-sc;
const ar=Math.abs(dr), ac=Math.abs(dc);

switch(p.toLowerCase()){
case"p":{
const d=p===p.toUpperCase()?-1:1;
if(dc==0&&!t&&(dr==d||(dr==2*d&&(sr==6||sr==1)&&!board[sr+d][sc]))) return true;
if(ar==1&&dr==d&&t) return true;
return false;}
case"r":return (sr==tr||sc==tc)&&clear(sr,sc,tr,tc);
case"n":return (ar==2&&ac==1)||(ar==1&&ac==2);
case"b":return ar==ac && clear(sr,sc,tr,tc);
case"q":return (ar==ac||sr==tr||sc==tc)&&clear(sr,sc,tr,tc);
case"k":return ar<=1 && ac<=1;
}
return false;
}

function clear(sr,sc,tr,tc){
const dr=Math.sign(tr-sr), dc=Math.sign(tc-sc);
let r=sr+dr,c=sc+dc;
while(r!=tr||c!=tc){
if(board[r][c]) return false;
r+=dr;c+=dc;
}
return true;
}

restart();
</script>

</body>
</html>