<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Catur PRO</title>

<style>
body{
    margin:0;
    background:#f5f7fa;
    font-family:system-ui, sans-serif;
    display:flex;
    flex-direction:column;
    align-items:center;
}
h1{ margin:15px 0 5px; font-weight:500; }
.info{ font-size:14px; color:#444; margin-bottom:10px; }

.board{
    width:95vw;
    max-width:480px;
    aspect-ratio:1;
    display:grid;
    grid-template-columns:repeat(8,1fr);
    border:2px solid #333;
}
.square{
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:clamp(22px,5vw,40px);
    user-select:none;
    cursor:pointer;
}
.light{ background:#fff; }
.dark{ background:#dcdcdc; }

/* üî¥ PUTIH DIGANTI MERAH */
.white{ 
    color:#e53935; 
    text-shadow:0 0 2px #000;
}

.black{ color:black; }

.selected{ outline:3px solid #4CAF50; }

button{
    margin:12px;
    padding:8px 16px;
    border:none;
    border-radius:20px;
    background:#333;
    color:white;
    cursor:pointer;
}
button:hover{ opacity:.8; }
</style>
</head>

<body>

<h1>Catur PRO</h1>
<div class="info" id="info">Giliran: Merah</div>
<div class="board" id="board"></div>
<button onclick="restart()">Restart</button>

<script>
const boardEl=document.getElementById("board");
const info=document.getElementById("info");

const pieces={
r:"‚ôú",n:"‚ôû",b:"‚ôù",q:"‚ôõ",k:"‚ôö",p:"‚ôü",
R:"‚ôñ",N:"‚ôò",B:"‚ôó",Q:"‚ôï",K:"‚ôî",P:"‚ôô"
};

let board,turn,selected,castle,enPassant;

function restart(){
board=[
["r","n","b","q","k","b","n","r"],
["p","p","p","p","p","p","p","p"],
["","","","","","","",""],
["","","","","","","",""],
["","","","","","","",""],
["","","","","","","",""],
["P","P","P","P","P","P","P","P"],
["R","N","B","Q","K","B","N","R"]
];
turn="white";
selected=null;
castle={wK:true,wQ:true,bK:true,bQ:true};
enPassant=null;
render();
info.textContent="Giliran: Merah";
}

function render(){
boardEl.innerHTML="";
for(let r=0;r<8;r++){
for(let c=0;c<8;c++){
const s=document.createElement("div");
s.className=`square ${(r+c)%2?"dark":"light"}`;
s.dataset.r=r;s.dataset.c=c;
const p=board[r][c];
if(p){
s.textContent=pieces[p];
s.classList.add(p===p.toUpperCase()?"white":"black");
}
s.onclick=()=>click(r,c,s);
boardEl.appendChild(s);
}}}

function click(r,c,el){
const p=board[r][c];
if(selected){
if(move(selected.r,selected.c,r,c)){
turn=turn==="white"?"black":"white";
info.textContent="Giliran: "+(turn==="white"?"Merah":"Hitam");
}
selected=null;render();return;
}
if(p && isMine(p)){
selected={r,c};
el.classList.add("selected");
}
}

function isMine(p){
return turn==="white"?p===p.toUpperCase():p===p.toLowerCase();
}

function move(sr,sc,tr,tc){
if(!legal(sr,sc,tr,tc)) return false;
const p=board[sr][sc];
board[tr][tc]=p;
board[sr][sc]="";

if(p.toLowerCase()=="p" && Math.abs(tr-sr)==2)
enPassant={r:(sr+tr)/2,c:sc};
else enPassant=null;

if(p=="K"){ castle.wK=false;castle.wQ=false;
if(sc==4&&tc==6){ board[7][5]="R";board[7][7]=""; }
if(sc==4&&tc==2){ board[7][3]="R";board[7][0]=""; }
}
if(p=="k"){ castle.bK=false;castle.bQ=false;
if(sc==4&&tc==6){ board[0][5]="r";board[0][7]=""; }
if(sc==4&&tc==2){ board[0][3]="r";board[0][0]=""; }
}

if(p.toLowerCase()=="p" && (tr==0||tr==7))
board[tr][tc]=turn==="white"?"Q":"q";

return true;
}

function legal(sr,sc,tr,tc){
const p=board[sr][sc];
const t=board[tr][tc];
if(t && isMine(t)) return false;
const dr=tr-sr, dc=tc-sc;
const ar=Math.abs(dr), ac=Math.abs(dc);

switch(p.toLowerCase()){
case"p":{
const d=p===p.toUpperCase()?-1:1;
if(dc==0&&!t&&(dr==d||(dr==2*d&&(sr==6||sr==1)&&!board[sr+d][sc]))) return true;
if(ar==1&&dr==d&&(t||enPassant&&enPassant.r==tr&&enPassant.c==tc)) return true;
return false;}
case"r":return (sr==tr||sc==tc)&&clear(sr,sc,tr,tc);
case"n":return (ar==2&&ac==1)||(ar==1&&ac==2);
case"b":return ar==ac && clear(sr,sc,tr,tc);
case"q":return (ar==ac||sr==tr||sc==tc)&&clear(sr,sc,tr,tc);
case"k":
if(ar<=1&&ac<=1) return true;
}
return false;
}

function clear(sr,sc,tr,tc){
const dr=Math.sign(tr-sr), dc=Math.sign(tc-sc);
let r=sr+dr,c=sc+dc;
while(r!=tr||c!=tc){
if(board[r][c]) return false;
r+=dr;c+=dc;
}
return true;
}

restart();
</script>
</body>
</html>